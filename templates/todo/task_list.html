{% extends "base.html" %}

{% load static %}

{% block content %}

  <div class="container mx-auto p-4">
    <div class="flex items-center justify-between mb-4">
      <h1 class="text-4xl font-bold">Task List</h1>
      <a href="{% url 'todo:task-create' %}"
         class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">New Task</a>
    </div>
    {% for task in task_list %}
      <div class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
        <div class="mb-4">
          <span class="font-bold text-gray-700 text-xl">{{ task.title }}</span>

          {% if task.is_done %}
            <span class="font-bold text-green-600">
            Done
          {% else %}
            <span class="font-bold text-red-600">
            Not Done
          {% endif %}
          {% if task.deadline %}
            <span class="text-sm text-gray-500"> (Deadline: {{ task.deadline }})</span>
          {% endif %}
          </span>
        </div>
        <p class="text-gray-700 text-base">{{ task.content }}</p>
        <div class="mt-4">
          <span class="text-gray-500 text-sm">Created at: {{ task.datetime }}</span>
        </div>
        <div class="mt-2">
          <span class="text-gray-500 text-sm">Tags: </span>
          {% for tag in task.tags.all %}
            <span class="inline-block bg-gray-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2">#{{ tag.name }}</span>
          {% endfor %}
        </div>
        <div class="mt-2">
          {% if task.is_done %}
            <a
                class="inline-block bg-yellow-200 text-yellow-800 px-3 py-1 text-sm font-semibold rounded-full"
                href="{% url 'todo:task-complete' task.id %}"
            >Undo</a>
          {% else %}
            <a
                href="{% url 'todo:task-complete' task.id %}"
                class="inline-block bg-green-200 text-green-800 px-3 py-1 text-sm font-semibold rounded-full"
            >
              Complete
            </a>
          {% endif %}
          <a href="{% url 'todo:task-update' task.id %}"
             class="inline-block bg-blue-200 text-blue-800 px-3 py-1 text-sm font-semibold rounded-full">Update</a>
          <form action="{% url 'todo:task-delete' task.id %}" method="POST" style="display: inline;">
            {% csrf_token %}
            <button type="submit"
                    class="inline-block bg-red-200 text-red-800 px-3 py-1 text-sm font-semibold rounded-full">Delete
            </button>
          </form>
        </div>
      </div>
    {% empty %}
      <p>No tasks yet.</p>
    {% endfor %}
  </div>

{% endblock %}
